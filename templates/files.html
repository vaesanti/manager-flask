{% extends "base.html" %}
{% block title %}Gerenciar Arquivos{% endblock %}
{% block content %}
<h1>Gerenciar Arquivos</h1>

<div class="card">
  <ul class="tree">
    {% macro render_node(node, idx=0) -%}
      {% if node.type == 'dir' %}
        <li>
          <details open>
            <summary class="folder">ðŸ“‚ {{ node.name }}</summary>
            <ul>
              {% for ch in node.children %}
                {{ render_node(ch, loop.index0 ~ idx) }}
              {% endfor %}
            </ul>
          </details>
        </li>
      {% else %}
        <li>
          <a class="file" href="{{ url_for('edit_file', file_path=node.path[1:] if node.path.startswith('/') else node.path) }}">
            ðŸ“„ {{ node.name }}
          </a>
        </li>
      {% endif %}
    {%- endmacro %}

    {% for t in trees %}
      {{ render_node(t) }}
    {% endfor %}
  </ul>
</div>
{% endblock %}
